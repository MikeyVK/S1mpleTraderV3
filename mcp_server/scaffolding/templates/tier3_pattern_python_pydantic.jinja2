{# TEMPLATE_METADATA:
  name: tier3_pattern_python_pydantic
  tier: 3
  category: pattern
  enforcement: ARCHITECTURAL
  purpose: "Pydantic v2 patterns for DTO/schema definitions"
  exports:
    - pattern_pydantic_imports
    - pattern_pydantic_base_model
    - pattern_pydantic_config
    - pattern_pydantic_field
    - pattern_pydantic_validator
#}

{#-
Tier 3 Pattern: Pydantic v2
- Macro library only: no extends, no blocks
- Keep output composable via {% import %}
- Prefer i18n keys for descriptions (no user-facing strings)
-#}

{% macro pattern_pydantic_imports(include_validation_error=false) -%}
from pydantic import BaseModel, ConfigDict, Field, field_validator{% if include_validation_error %}, ValidationError{% endif %}
{%- endmacro %}

{% macro pattern_pydantic_base_model(class_name="MyModel") -%}
class {{ class_name }}(BaseModel):
    """{{ class_name }} DTO."""
{%- endmacro %}

{% macro pattern_pydantic_config(extra="forbid", frozen=true) -%}
    model_config = ConfigDict(extra="{{ extra }}", frozen={{ 'True' if frozen else 'False' }})
{%- endmacro %}

{% macro pattern_pydantic_field(name, type_, description_key, default="...") -%}
    {{ name }}: {{ type_ }} = Field({{ default }}, description="{{ description_key }}")
{%- endmacro %}

{% macro pattern_pydantic_validator(field_name, value_type="str") -%}
    @field_validator("{{ field_name }}")
    @classmethod
    def validate_{{ field_name }}(cls, v: {{ value_type }}):
        return v
{%- endmacro %}
