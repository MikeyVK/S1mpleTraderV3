{# TEMPLATE_METADATA:
  name: tier3_pattern_python_log_enricher
  tier: 3
  category: pattern
  enforcement: ARCHITECTURAL
  purpose: "LogEnricher usage patterns (structured logging + indent)"
  exports:
    - pattern_log_enricher_imports
    - pattern_log_enricher_set_logger
    - pattern_log_enricher_child
#}

{#-
Tier 3 Pattern: LogEnricher
- Macro library only: no extends, no blocks
- Use message keys (i18n) instead of user-facing strings
-#}

{% macro pattern_log_enricher_imports() -%}
from backend.utils.app_logger import LogEnricher
{%- endmacro %}

{% macro pattern_log_enricher_set_logger(attr_name="logger") -%}
self.{{ attr_name }} = logger
{%- endmacro %}

{% macro pattern_log_enricher_child(indent_delta=1) -%}
child_logger = LogEnricher(
    self.logger.logger,
    indent=self.logger.extra.get("indent", 0) + {{ indent_delta }},
)
{%- endmacro %}
