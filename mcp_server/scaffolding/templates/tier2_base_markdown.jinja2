{#- tier2_base_markdown.jinja2 - Language base for Markdown documents -#}
{#- Version: 2.3.0 -#}
{#- Purpose: Adds Markdown-specific patterns (frontmatter, code blocks, link definitions) -#}
{%- extends "tier1_base_document.jinja2" -%}

{#-
TEMPLATE_METADATA:
  enforcement: STRICT
  level: format
  validates:
    strict:
      - "^# "
      - "^## "
      - "^---$"
  extends: tier1_base_document.jinja2
  purpose: "Language base for Markdown - adds frontmatter, code blocks, link definitions"
  version: "2.3.0"
  changelog:
    - version: "2.3.0"
      date: "2026-01-26"
      changes: "Fixed whitespace in Related Documentation section"
    - version: "2.2.0"
      date: "2026-01-26"
      changes: "Fixed whitespace: newline after frontmatter, proper link definition spacing"
    - version: "2.1.0"
      date: "2026-01-26"
      changes: "Changed enforcement from ARCHITECTURAL to STRICT (tier2 = BASE template)"
    - version: "2.0.0"
      date: "2026-01-26"
      changes: "Added link definitions section before Version History"
    - version: "1.0.0"
      date: "2026-01-25"
      changes: "Initial version with frontmatter and code blocks"
  introspection:
    template_id: tier2_base_markdown
    tier: 2
    parent: tier1_base_document
    variables:
      required:
        - title
      optional:
        - frontmatter
        - sections
        - code_blocks
        - related_docs
    exports_blocks:
      - frontmatter_block
      - code_section
      - link_definitions
-#}

{%- block content -%}
{%- block frontmatter_block %}
{%- if frontmatter -%}
---
{%- for key, value in frontmatter.items() %}
{{ key }}: {{ value }}
{%- endfor %}
---

{%- endif -%}
{%- endblock %}

# {{ title }}

**Status:** {{ status | default("Draft") }} | **Phase:** {{ phase | default("Design") }}

---

## Purpose

{{ purpose }}

## Scope

**In Scope:**
{{ scope_in }}

**Out of Scope:**
{{ scope_out }}

{% if prerequisites -%}
## Prerequisites

{% for prereq in prerequisites -%}
- {{ prereq }}
{% endfor -%}
{%- endif %}

{%- block document_content %}{% endblock %}

{%- block code_section -%}
{%- if code_blocks -%}
{%- for block in code_blocks %}

```{{ block.language | default('') }}
{{ block.code }}
```
{%- endfor -%}
{%- endif -%}
{%- endblock %}

{%- block link_definitions -%}
{%- if related_docs %}

<!-- Link definitions -->

{% for doc in related_docs -%}
[{{ doc.split('/')[-1].replace('.md', '') }}]: {{ doc }}
{% endfor -%}
{%- endif -%}
{%- endblock %}

## Related Documentation

{%- if related_docs %}

{% for doc in related_docs -%}
- [{{ doc.split('/')[-1].replace('.md', '') }}][{{ doc.split('/')[-1].replace('.md', '') }}]
{% endfor -%}
{%- else %}

None
{%- endif %}

## Version History

| Version | Date | Changes | Author |
|---------|------|---------|--------|
| 0.1 | {{ timestamp }} | Initial draft | Agent |

{%- endblock %}
