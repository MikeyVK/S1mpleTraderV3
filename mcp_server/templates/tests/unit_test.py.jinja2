# artifact: type={{ template_id }}, version={{ template_version }}, created={{ scaffold_created }}
{% if fixtures %}# pylint: disable=redefined-outer-name  # pytest fixtures
{% endif %}"""
Unit tests for {{ component_name }}.

{{ purpose }}
{% if tdd_mode %}Following TDD: These tests are written BEFORE implementation (RED phase).{% endif %}

@layer: Tests (Unit)
@dependencies: [pytest{% if dependencies %}, {{ dependencies | join(', ') }}{% endif %}]
@responsibilities:
{% for responsibility in responsibilities %}    - {{ responsibility }}
{% endfor %}
"""
{% if test_private_methods %}
# pyright: basic, reportPrivateUsage=false
{% endif %}
# Standard library
from pathlib import Path
from typing import Any
from unittest.mock import Mock, MagicMock

# Third-party
import pytest
{% if extra_third_party_imports %}
{% for import_line in extra_third_party_imports %}
{{ import_line }}
{% endfor %}
{% endif %}

# Project modules
from {{ module_path }} import (
    {{ component_name }},
)
{% if exception_imports %}
from mcp_server.core.exceptions import (
{% for exc in exception_imports %}    {{ exc }},
{% endfor %})
{% endif %}
{% if extra_project_imports %}
{% for import_line in extra_project_imports %}
{{ import_line }}
{% endfor %}
{% endif %}

{% if fixtures %}
{% for fixture in fixtures %}
@pytest.fixture(name="{{ fixture.name }}")
def fixture_{{ fixture.name }}({% if fixture.params %}{{ fixture.params | join(', ') }}{% endif %}) -> {{ fixture.return_type }}:
    """{{ fixture.purpose }}"""
{% if fixture.implementation %}    {{ fixture.implementation | indent(4) }}
{% else %}    # TODO: Implement fixture
    pass
{% endif %}

{% endfor %}
{% endif %}

class Test{{ component_name }}:
    """Tests for {{ component_name }}."""
{% if test_methods %}
{% for test in test_methods %}

    {% if test.is_async %}@pytest.mark.asyncio
    async def test_{{ test.name }}(
{% else %}    def test_{{ test.name }}(
{% endif %}        self{% if test.fixtures %},
{% for fixture_name in test.fixtures %}        {{ fixture_name }}: {{ test.fixture_types[loop.index0] }}{{ ',' if not loop.last else '' }}
{% endfor %}{% endif %}
    ) -> None:
        """{{ test.docstring }}"""
{% if test.structure == 'given_when_then' %}        # Arrange
        # TODO: Setup test data and mocks

        # Act
        # TODO: Execute method under test

        # Assert
        # TODO: Verify expected outcomes
{% else %}        # TODO: Implement test
        pass
{% endif %}
{% endfor %}
{% else %}

    def test_placeholder(self) -> None:
        """Placeholder test - replace with actual tests."""
        assert True
{% endif %}
